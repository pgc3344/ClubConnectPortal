<!-- templates/profile.html -->
{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-8 mx-auto">
        <div class="card">
            <div class="card-body">
                <h2 class="card-title">ë‚´ í”„ë¡œí•„</h2>
                <table class="table">
                    <tr>
                        <th width="30%">í•™ë²ˆ:</th>
                        <td>{{ user.student_id }}</td>
                    </tr>
                    <tr>
                        <th>ì´ë¦„:</th>
                        <td>{{ user.name }}</td>
                    </tr>
                    {% if user.club_leader_of %}
                    <tr>
                        <th>ë¶€ì¥:</th>
                        <td>
                            <span class="badge bg-primary">ë¶€ì¥</span>
                        </td>
                    </tr>
                    {% endif %}
                    {% if user.is_admin %}
                    <tr>
                        <th>ê¶Œí•œ:</th>
                        <td>
                            <span class="badge bg-danger">ê´€ë¦¬ì</span>
                        </td>
                    </tr>
                    {% endif %}
                </table>

                <h3 class="mt-4">ë™ì•„ë¦¬ ì‹ ì²­ í˜„í™©</h3>
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ë™ì•„ë¦¬ëª…</th>
                                <th>ì—°ë½ì²˜</th>
                                <th>ì‹ ì²­ì¼</th>
                                <th>ìƒíƒœ</th>
                                <th>ê²°ê³¼</th>
                                <th>ì•¡ì…˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for app in applications %}
                            <tr>
                                <td>{{ app.name }}</td>
                                <td>
                                    {% if app.contact_info %}
                                        {% if app.contact_method == 'phone' %}
                                            ğŸ“ {{ app.contact_info }}
                                        {% else %}
                                            ì¹´ì¹´ì˜¤í†¡: {{ app.contact_info }}
                                        {% endif %}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                                <td>{{ app.applied_at }}</td>
                                <td>
                                    {% if app.status == 'pending' %}
                                        <span class="badge bg-warning">ê²€í† ì¤‘</span>
                                    {% elif app.status == 'waiting_acceptance' %}
                                        <span class="badge bg-info">ìŠ¹ì¸ë¨ (ìˆ˜ë½ ëŒ€ê¸°)</span>
                                    {% elif app.status == 'approved' %}
                                        <span class="badge bg-success">ìµœì¢… ìŠ¹ì¸</span>
                                    {% elif app.status == 'withdrawn' %}
                                        <span class="badge bg-secondary">íƒˆí‡´</span>
                                    {% elif app.status == 'cancelled' %}
                                        <span class="badge bg-warning">ì·¨ì†Œë¨</span>
                                    {% elif app.status == 'club_deleted' %}
                                        <span class="badge bg-danger">ë™ì•„ë¦¬ íì§€</span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if app.final_result %}
                                        {{ app.final_result }}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                                <td>
                                    {% if app.status == 'approved' %}
                                        <form action="{{ url_for('withdraw_club', application_id=app.id) }}" 
                                              method="post" onsubmit="return confirm('ì •ë§ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì£¼ì˜: ê´€ë¦¬ìì˜ í—ˆê°€í•˜ì— ì‚¬ìš©í•˜ì„¸ìš”.');">
                                            <button type="submit" class="btn btn-danger btn-sm">íƒˆí‡´</button>
                                        </form>
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}